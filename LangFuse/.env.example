# LangFuse V3 Docker Compose Environment Variables
# Copy this file to .env and update the values
#
# V3 Architecture: Web Server + Worker + PostgreSQL + ClickHouse + Redis + MinIO
# The worker container processes async queue jobs for ingestion and analytics

# ============================================================================
# REQUIRED: Database Configuration
# ============================================================================
POSTGRES_USER=langfuse
POSTGRES_PASSWORD=langfuse
# URL-encoded password for connection string (/ becomes %2F, @ becomes %40, etc.)
POSTGRES_PASSWORD_ENCODED=langfuse
POSTGRES_DB=langfuse
POSTGRES_PORT=5432

# ============================================================================
# REQUIRED: ClickHouse Configuration (V3)
# ============================================================================
CLICKHOUSE_USER=langfuse
CLICKHOUSE_PASSWORD=langfuse_secure_password
CLICKHOUSE_DB=default
CLICKHOUSE_PORT=8123
CLICKHOUSE_CLUSTER_ENABLED=false

# ============================================================================
# REQUIRED: Redis Configuration (V3)
# ============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_AUTH=redis_secure_password

# ============================================================================
# REQUIRED: MinIO/S3 Configuration (V3)
# ============================================================================
MINIO_ROOT_USER=minio
MINIO_ROOT_PASSWORD=minio_secure_password
LANGFUSE_S3_EVENT_UPLOAD_BUCKET=langfuse
LANGFUSE_S3_MEDIA_UPLOAD_BUCKET=langfuse

# ============================================================================
# REQUIRED: Authentication Secrets
# ============================================================================
# Generate with: openssl rand -hex 32
NEXTAUTH_SECRET=$(openssl rand -hex 32)
SALT=$(openssl rand -hex 32)
ENCRYPTION_KEY=$(openssl rand -hex 32)

# ============================================================================
# REQUIRED: Server Configuration
# ============================================================================
# Update with your VM's IP or domain
NEXTAUTH_URL=http://20.10.192.136:3000
LANGFUSE_PORT=3000
NODE_ENV=production

# ============================================================================
# OPTIONAL: Feature Flags
# ============================================================================
TELEMETRY_ENABLED=true
LANGFUSE_ENABLE_EXPERIMENTAL_FEATURES=false

# ============================================================================
# OPTIONAL: Email Notifications
# ============================================================================
# EMAIL_FROM=noreply@yourdomain.com
# SMTP_CONNECTION_URL=smtp://username:password@smtp.example.com:587

# ============================================================================
# OPTIONAL: S3 Storage for Media
# ============================================================================
# S3_ENDPOINT=https://s3.amazonaws.com
# S3_ACCESS_KEY_ID=your-access-key
# S3_SECRET_ACCESS_KEY=your-secret-key
# S3_BUCKET_NAME=langfuse-media
# S3_REGION=us-east-1

# ============================================================================
# OPTIONAL: OAuth Providers
# ============================================================================
# Google OAuth
# AUTH_GOOGLE_CLIENT_ID=your-google-client-id
# AUTH_GOOGLE_CLIENT_SECRET=your-google-client-secret

# GitHub OAuth
# AUTH_GITHUB_CLIENT_ID=your-github-client-id
# AUTH_GITHUB_CLIENT_SECRET=your-github-client-secret

# ============================================================================
# OPTIONAL: Advanced Configuration
# ============================================================================
HOSTNAME=0.0.0.0

# ============================================================================
# Quick Setup Commands
# ============================================================================
# 1. Generate secrets (using hex to avoid special characters):
#    NEXTAUTH_SECRET=$(openssl rand -hex 32)
#    SALT=$(openssl rand -hex 32)
#    ENCRYPTION_KEY=$(openssl rand -hex 32)
#
# 2. Generate and encode PostgreSQL password:
#    POSTGRES_PASSWORD=$(openssl rand -hex 16)
#    POSTGRES_PASSWORD_ENCODED=$(python3 -c "import urllib.parse; print(urllib.parse.quote('$POSTGRES_PASSWORD', safe=''))")
#
# 3. Generate service passwords:
#    CLICKHOUSE_PASSWORD=$(openssl rand -hex 16)
#    REDIS_AUTH=$(openssl rand -hex 16)
#    MINIO_ROOT_PASSWORD=$(openssl rand -hex 16)
#
# 4. Update NEXTAUTH_URL with your VM IP:
#    NEXTAUTH_URL=http://$(hostname -I | awk '{print $1}'):3000
#
# 5. Or use the automated deploy.sh script:
#    ./deploy.sh
